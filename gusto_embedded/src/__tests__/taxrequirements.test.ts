/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { expect, test } from "vitest";
import { GustoEmbedded } from "../index.js";
import { createTestHTTPClient } from "./testclient.js";

test("Taxrequirements Get V1 Companies Company Uuid Tax Requirements State Example Tax Requirements For Ga", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "get-v1-companies-company_uuid-tax_requirements-state-Example Tax Requirements for GA",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  const result = await gustoEmbedded.taxRequirements.getByState({
    companyUuid: "<id>",
    state: "New Mexico",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    companyUuid: "6c14eac3-0da2-474d-bda1-786b3602d381",
    state: "GA",
    requirementSets: [
      {
        state: "GA",
        key: "registrations",
        label: "Registrations",
        effectiveFrom: null,
        requirements: [
          {
            key: "71653ec0-00b5-4c66-a58b-22ecf21704c5",
            applicableIf: [],
            label: "Withholding Number",
            description:
              "If you have run payroll in the past in GA, find your withholding number on notices received from the Georgia Department of Revenue, or call the agency at (877) 423-6711. If you don’t have a number yet, you should <a target='_blank' data-bypass href='https://gtc.dor.ga.gov/_/#1'>register the business online</a>. The last two characters of your ID must be upper case letters.",
            value: "1233214-AB",
            metadata: {
              type: "text",
            },
          },
          {
            key: "6c0911ab-5860-412e-bdef-6437cd881df5",
            applicableIf: [],
            label: "DOL Account Number",
            description:
              "If you have run payroll in the past in GA, find your DOL account number on notices received from the Georgia Department of Labor, or call the agency at (404) 232-3300. If you don’t have an account number yet, please <a target='_blank' data-bypass href='https://support.gusto.com/hc/en-us/articles/210139038#registerdol'>follow the instructions here</a> to register your business with the Georgia Dept. of Labor.",
            value: "474747-88",
            metadata: {
              type: "text",
            },
          },
        ],
      },
      {
        state: "GA",
        key: "taxrates",
        label: "Tax Rates",
        effectiveFrom: "2022-01-01",
        requirements: [
          {
            key: "e0ac2284-8d30-4100-ae23-f85f9574868b",
            applicableIf: [],
            label: "Total Tax Rate",
            description:
              "Haven't received your assigned rate yet? <a target='_blank' data-bypass href='https://support.gusto.com/article/106622236100000/State-unemployment-insurance-(SUI)-tax'>Find the new employer rate</a> and enter it here.",
            value: "0.05",
            metadata: {
              type: "tax_rate",
              validation: {
                type: "min_max",
                min: "0.0004",
                max: "0.081",
              },
            },
          },
        ],
      },
      {
        state: "GA",
        key: "depositschedules",
        label: "Deposit Schedules",
        effectiveFrom: "2022-01-01",
        requirements: [
          {
            key: "6ddfcbeb-94d3-4003-bfc2-8c6e1ca9f70c",
            applicableIf: [],
            label: "Deposit Schedule",
            description:
              "Georgia rejects payments made on the wrong schedule. GA employers receive their schedule on a registration verification letter after registering with the Georgia Dept. of Revenue. If you are unsure, call the agency at (877) 423-6711. If you did not register your business yet, please <a target='_blank' data-bypass href='https://gtc.dor.ga.gov/_/#2'>register the business with the Georgia Dept. of Revenue</a>.",
            value: "Semi-weekly",
            metadata: {
              type: "select",
              options: [
                {
                  label: "Semiweekly",
                  value: "Semi-weekly",
                },
                {
                  label: "Monthly",
                  value: "Monthly",
                },
                {
                  label: "Quarterly",
                  value: "Quarterly",
                },
              ],
            },
          },
        ],
      },
    ],
  });
});

test("Taxrequirements Put V1 Companies Company Uuid Tax Requirements State Example", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "put-v1-companies-company_uuid-tax_requirements-state-Example",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  await gustoEmbedded.taxRequirements.update({
    companyUuid: "<id>",
    state: "New Jersey",
    requestBody: {
      requirementSets: [
        {
          key: "registrations",
          effectiveFrom: null,
          state: "GA",
          requirements: [
            {
              key: "71653ec0-00b5-4c66-a58b-22ecf21704c5",
              value: "1233214-AB",
            },
            {
              key: "6c0911ab-5860-412e-bdef-6437cd881df5",
              value: "474747-22",
            },
          ],
        },
        {
          key: "taxrates",
          effectiveFrom: "2022-01-01",
          state: "GA",
          requirements: [
            {
              key: "e0ac2284-8d30-4100-ae23-f85f9574868b",
              value: "0.05",
            },
          ],
        },
        {
          key: "depositschedules",
          effectiveFrom: "2022-01-01",
          state: "GA",
          requirements: [
            {
              key: "6ddfcbeb-94d3-4003-bfc2-8c6e1ca9f70c",
              value: "Semi-weekly",
            },
          ],
        },
      ],
    },
  });
});

test("Taxrequirements Put V1 Companies Company Uuid Tax Requirements State Basic", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "put-v1-companies-company_uuid-tax_requirements-state-Basic",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  await gustoEmbedded.taxRequirements.update({
    companyUuid: "<id>",
    state: "West Virginia",
    requestBody: {},
  });
});

test("Taxrequirements Put V1 Companies Company Uuid Tax Requirements State Resource", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "put-v1-companies-company_uuid-tax_requirements-state-Resource",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  await gustoEmbedded.taxRequirements.update({
    companyUuid: "<id>",
    state: "Washington",
    requestBody: {},
  });
});

test("Taxrequirements Put V1 Companies Company Uuid Tax Requirements State Nested", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "put-v1-companies-company_uuid-tax_requirements-state-Nested",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  await gustoEmbedded.taxRequirements.update({
    companyUuid: "<id>",
    state: "Mississippi",
    requestBody: {},
  });
});

test("Taxrequirements Get V1 Companies Company Uuid Tax Requirements Company With Requirements In Ca And Ga", async () => {
  const gustoEmbedded = new GustoEmbedded({
    httpClient: createTestHTTPClient(
      "get-v1-companies-company_uuid-tax_requirements-Company with requirements in CA and GA",
    ),
    companyAccessAuth: process.env["GUSTOEMBEDDED_COMPANY_ACCESS_AUTH"] ?? "",
  });

  const result = await gustoEmbedded.taxRequirements.getAll({
    companyUuid: "<id>",
  });
  expect(result).toBeDefined();
  expect(result).toEqual([
    {
      state: "CA",
      setupComplete: true,
    },
    {
      state: "GA",
      setupComplete: false,
    },
  ]);
});
